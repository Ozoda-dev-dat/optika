You are a SENIOR FULL-STACK DEVELOPER.

I have an existing Optical Store Management System project.
Your task is to fix and complete it STRICTLY according to the provided TZZ.

IMPORTANT RULE:
• DO NOT add any feature not listed below
• DO NOT refactor unrelated code
• DO NOT optimize unless required to make it work
• FOLLOW THE STEPS IN ORDER

────────────────────────
STEP 1. COMPILE & RUNTIME BLOCKERS
────────────────────────
1.1 Identify all TypeScript / runtime errors that prevent build or run
1.2 Fix missing imports, interfaces, and type mismatches
1.3 Ensure the project builds successfully without errors

────────────────────────
STEP 2. DATABASE vs CODE CONSISTENCY
────────────────────────
2.1 Find all fields used in code but missing in DB schema
2.2 Add ONLY the missing fields required by existing code
2.3 Do NOT redesign tables, only minimal fixes

────────────────────────
STEP 3. INVENTORY LOGIC (CRITICAL)
────────────────────────
3.1 Ensure inventory decreases on sale
3.2 Prevent selling products when stock is insufficient
3.3 Ensure inventory increases on return
3.4 Ensure all inventory changes are done inside DB transactions

────────────────────────
STEP 4. SALES RETURN (REFUND)
────────────────────────
4.1 Implement sale return logic if missing
4.2 Restore inventory on return
4.3 Recalculate sale totals and financial impact
4.4 Do NOT add advanced refund features

────────────────────────
STEP 5. INVENTORY TRANSFER (BRANCH TO BRANCH)
────────────────────────
5.1 Implement inventory transfer between branches
5.2 Decrease source branch stock
5.3 Increase destination branch stock
5.4 Log transfer operation

────────────────────────
STEP 6. KPI & EMPLOYEE LOGIC (MINIMAL)
────────────────────────
6.1 Ensure employee sale tracking works
6.2 Calculate KPI based ONLY on sales amount
6.3 Do NOT add payroll automation beyond TZZ

────────────────────────
STEP 7. FINANCE (PROFIT / LOSS)
────────────────────────
7.1 Calculate total sales income
7.2 Subtract expenses
7.3 Provide basic profit/loss values
7.4 No forecasting, no advanced analytics

────────────────────────
STEP 8. ANALYTICS (MINIMAL DASHBOARD)
────────────────────────
8.1 Best-selling products
8.2 Low-stock products
8.3 Top employees
8.4 Use existing data only

────────────────────────
STEP 9. ACCESS CONTROL
────────────────────────
9.1 Enforce role-based access (admin, manager, staff)
9.2 Do NOT create new roles
9.3 Restrict sensitive endpoints

────────────────────────
OUTPUT FORMAT (MANDATORY)
────────────────────────
• List completed steps (1–9)
• For each step:
  - What was changed
  - Which files were modified
• Provide FULL updated file content (not diffs)
• No explanations outside these steps
